<head>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.2/moment.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

  <link data-require="bootstrap-css@*" data-semver="3.3.5" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" />
  
  <?!= include('style'); ?>
  
</head>



<body>

  <!-- navigation -->
  <div><?!= include('navbar'); ?></div>
  
  <div class="container-fluid">
  
      <!-- Home page -->
      <div class="page" id="home">
        <div class="row vertical-center">
          <a class="btn btn-lg btn-primary" type="button" id="subReqBtn">Submit Supply Request</a>
          <button class="btn btn-lg btn-primary btn-validated" type="button" id="procReqBtn" disabled="disabled">
            Process Supply Requests <!-- <span class="badge">4</span> -->
          </button>
        </div>
      </div>
      
      <!-- request form page -->
      <div class="page" id="reqForm" style="display:none"><?!= include('request_form'); ?></div>
      
      <!-- request confirmation page -->
      <div class="page" id="reqConfirm" style="display:none"><?!= include('request_confirmation'); ?></div>
      
      <!-- process requests page -->
      <div class="page" id="procPage" style="display:none"><?!= include('process_requests'); ?></div>
      
  </div>

</body>



<script>
$(function(){

  $(document).ready(loadHomeActions);
  $('#subReqBtn').click(loadReqForm);
  $('#procReqBtn').click(loadProcPage);
  
  function loadHomeActions(){
    google.script.run.withSuccessHandler(verifyUser).validateUser();
  }
  
  function loadReqForm(resultHtml){
    $('.page').hide();
    $('#reqForm').show();
    $('#resetReq').click();
  }
  
  function loadProcPage(){
    google.script.run.withSuccessHandler(updateActionItems).getRequestActionItems();
    $('.page').hide();
    $('.reqData').hide();
    $('.reqForm').hide();
    $('#actionItems').show();
    $('#procPage').show();
  }
  
  function verifyUser(answer){
    if(answer == true){
      $('.btn-validated').prop('disabled', false);
    }
  }
  
  function updateActionItems(resultHtml){
    var $output = $('#actionItems');
    $output.html(resultHtml);
  }    

});

</script>